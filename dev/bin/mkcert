#!/usr/bin/env bash

PROJECT_DIR=$(realpath "$( cd -- "$( dirname -- "${BASH_SOURCE[0]}" )" &> /dev/null && pwd )"/../..)

INSTALL_DIR="$PROJECT_DIR"/dev/bin/.mkcert
INSTALL_BIN="$INSTALL_DIR"/mkcert.exe

# IF we are running this script from within Git Bash for Windows...
if [[ "$(uname)" = MINGW64_NT* ]]; then

    if [ ! -f "$INSTALL_BIN" ]; then
        mkdir -p "$INSTALL_DIR"
        echo "Installing mkcert in Project..."
        curl -JL https://dl.filippo.io/mkcert/latest?for=windows/amd64 -o "$INSTALL_BIN"
    fi

    # NOTE: Otherwise paths starting with / are prefixed with "C:\Program Files\Git"
    export MSYS_NO_PATHCONV=1
else
    echo "This shell is not currently supported!"
    exit
fi

"$INSTALL_BIN" "$@"
